> XGBoostçš„å¨åæƒ³å¿…å¤§å®¶éƒ½æœ‰æ‰€è€³é—»ï¼Œå®ƒä¸ä»…æ˜¯æ•°æ®ç§‘å­¦ç«žèµ›ç¥žå™¨ï¼Œåœ¨å·¥ä¸šç•Œä¸­ä¹Ÿè¢«å¹¿æ³›åœ°ä½¿ç”¨ã€‚æœ¬æ–‡ç»™å¤§å®¶åˆ†äº«çè—è®¸ä¹…çš„XGBoosté«˜é¢‘é¢è¯•é¢˜ï¼Œå¸Œæœ›èƒ½å¤ŸåŠ æ·±å¤§å®¶å¯¹XGBoostçš„ç†è§£ï¼Œæ›´é‡è¦çš„æ˜¯èƒ½å¤Ÿåœ¨æ‰¾æœºä¼šæ—¶æä¾›ä¸€äº›å¸®åŠ©ã€‚



### 1. XGBoostå¦‚ä½•å¤„ç†ä¸å¹³è¡¡æ•°æ®

å¯¹äºŽä¸å¹³è¡¡çš„æ•°æ®é›†ï¼Œä¾‹å¦‚ç”¨æˆ·çš„è´­ä¹°è¡Œä¸ºï¼Œè‚¯å®šæ˜¯æžå…¶ä¸å¹³è¡¡çš„ï¼Œè¿™å¯¹XGBoostçš„è®­ç»ƒæœ‰å¾ˆå¤§çš„å½±å“ï¼ŒXGBoostæœ‰ä¸¤ç§è‡ªå¸¦çš„æ–¹æ³•æ¥è§£å†³ï¼š

ç¬¬ä¸€ç§ï¼Œå¦‚æžœä½ åœ¨æ„AUCï¼Œé‡‡ç”¨AUCæ¥è¯„ä¼°æ¨¡åž‹çš„æ€§èƒ½ï¼Œé‚£ä½ å¯ä»¥é€šè¿‡è®¾ç½®scale_pos_weightæ¥å¹³è¡¡æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬çš„æƒé‡ã€‚ä¾‹å¦‚ï¼Œå½“æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ä¸º1:10æ—¶ï¼Œscale_pos_weightå¯ä»¥å–10ï¼›

ç¬¬äºŒç§ï¼Œå¦‚æžœä½ åœ¨æ„æ¦‚çŽ‡(é¢„æµ‹å¾—åˆ†çš„åˆç†æ€§)ï¼Œä½ ä¸èƒ½é‡æ–°å¹³è¡¡æ•°æ®é›†(ä¼šç ´åæ•°æ®çš„çœŸå®žåˆ†å¸ƒ)ï¼Œåº”è¯¥è®¾ç½®max_delta_stepä¸ºä¸€ä¸ªæœ‰é™æ•°å­—æ¥å¸®åŠ©æ”¶æ•›ï¼ˆåŸºæ¨¡åž‹ä¸ºLRæ—¶æœ‰æ•ˆï¼‰ã€‚

åŽŸè¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼š

```
For common cases such as ads clickthrough log, the dataset is extremely imbalanced. This can affect the training of xgboost model, 
and there are two ways to improve it.
  If you care only about the ranking order (AUC) of your prediction
      Balance the positive and negative weights, via scale_pos_weight
      Use AUC for evaluation
  If you care about predicting the right probability
      In such a case, you cannot re-balance the dataset
      In such a case, set parameter max_delta_step to a finite number (say 1) will help convergence
```

é‚£ä¹ˆï¼Œæºç åˆ°åº•æ˜¯æ€Žä¹ˆåˆ©ç”¨**scale_pos_weight**æ¥å¹³è¡¡æ ·æœ¬çš„å‘¢ï¼Œæ˜¯è°ƒèŠ‚æƒé‡è¿˜æ˜¯è¿‡é‡‡æ ·å‘¢ï¼Ÿè¯·çœ‹æºç ï¼š

```
if (info.labels[i] == 1.0f)  w *= param_.scale_pos_weight
```

å¯ä»¥çœ‹å‡ºï¼Œåº”è¯¥æ˜¯å¢žå¤§äº†å°‘æ•°æ ·æœ¬çš„æƒé‡ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸Šé‡‡æ ·ã€ä¸‹é‡‡æ ·ã€SMOTEç®—æ³•æˆ–è€…è‡ªå®šä¹‰ä»£ä»·å‡½æ•°çš„æ–¹å¼è§£å†³æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡çš„é—®é¢˜ã€‚



### 2. æ¯”è¾ƒLRå’ŒGBDTï¼Œè¯´è¯´ä»€ä¹ˆæƒ…æ™¯ä¸‹GBDTä¸å¦‚LR

å…ˆè¯´è¯´LRå’ŒGBDTçš„åŒºåˆ«ï¼š

- LRæ˜¯çº¿æ€§æ¨¡åž‹ï¼Œå¯è§£é‡Šæ€§å¼ºï¼Œå¾ˆå®¹æ˜“å¹¶è¡ŒåŒ–ï¼Œä½†å­¦ä¹ èƒ½åŠ›æœ‰é™ï¼Œéœ€è¦å¤§é‡çš„äººå·¥ç‰¹å¾å·¥ç¨‹
- GBDTæ˜¯éžçº¿æ€§æ¨¡åž‹ï¼Œå…·æœ‰å¤©ç„¶çš„ç‰¹å¾ç»„åˆä¼˜åŠ¿ï¼Œç‰¹å¾è¡¨è¾¾èƒ½åŠ›å¼ºï¼Œä½†æ˜¯æ ‘ä¸Žæ ‘ä¹‹é—´æ— æ³•å¹¶è¡Œè®­ç»ƒï¼Œè€Œä¸”æ ‘æ¨¡åž‹å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆï¼›

å½“åœ¨é«˜ç»´ç¨€ç–ç‰¹å¾çš„åœºæ™¯ä¸‹ï¼ŒLRçš„æ•ˆæžœä¸€èˆ¬ä¼šæ¯”GBDTå¥½ã€‚åŽŸå› å¦‚ä¸‹ï¼š

å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š

> å‡è®¾ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œlabelä¸º0å’Œ1ï¼Œç‰¹å¾æœ‰100ç»´ï¼Œå¦‚æžœæœ‰1wä¸ªæ ·æœ¬ï¼Œä½†å…¶ä¸­åªè¦10ä¸ªæ­£æ ·æœ¬1ï¼Œè€Œè¿™äº›æ ·æœ¬çš„ç‰¹å¾ f1çš„å€¼ä¸ºå…¨ä¸º1ï¼Œè€Œå…¶ä½™9990æ¡æ ·æœ¬çš„f1ç‰¹å¾éƒ½ä¸º0(åœ¨é«˜ç»´ç¨€ç–çš„æƒ…å†µä¸‹è¿™ç§æƒ…å†µå¾ˆå¸¸è§)ã€‚
>
> æˆ‘ä»¬éƒ½çŸ¥é“åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ‘æ¨¡åž‹å¾ˆå®¹æ˜“ä¼˜åŒ–å‡ºä¸€ä¸ªä½¿ç”¨f1ç‰¹å¾ä½œä¸ºé‡è¦åˆ†è£‚èŠ‚ç‚¹çš„æ ‘ï¼Œå› ä¸ºè¿™ä¸ªç»“ç‚¹ç›´æŽ¥èƒ½å¤Ÿå°†è®­ç»ƒæ•°æ®åˆ’åˆ†çš„å¾ˆå¥½ï¼Œä½†æ˜¯å½“æµ‹è¯•çš„æ—¶å€™ï¼Œå´ä¼šå‘çŽ°æ•ˆæžœå¾ˆå·®ï¼Œå› ä¸ºè¿™ä¸ªç‰¹å¾f1åªæ˜¯åˆšå¥½å¶ç„¶é—´è·Ÿyæ‹Ÿåˆåˆ°äº†è¿™ä¸ªè§„å¾‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è¯´çš„è¿‡æ‹Ÿåˆã€‚

é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœé‡‡ç”¨LRçš„è¯ï¼Œåº”è¯¥ä¹Ÿä¼šå‡ºçŽ°ç±»ä¼¼è¿‡æ‹Ÿåˆçš„æƒ…å†µå‘€ï¼šy = W1*f1 + Wi*fi+â€¦.ï¼Œå…¶ä¸­ W1ç‰¹åˆ«å¤§ä»¥æ‹Ÿåˆè¿™10ä¸ªæ ·æœ¬ã€‚ä¸ºä»€ä¹ˆæ­¤æ—¶æ ‘æ¨¡åž‹å°±è¿‡æ‹Ÿåˆçš„æ›´ä¸¥é‡å‘¢ï¼Ÿ

==ä»”ç»†æƒ³æƒ³å‘çŽ°ï¼Œå› ä¸ºçŽ°åœ¨çš„æ¨¡åž‹æ™®ééƒ½ä¼šå¸¦ç€æ­£åˆ™é¡¹ï¼Œè€Œ LR ç­‰çº¿æ€§æ¨¡åž‹çš„æ­£åˆ™é¡¹æ˜¯å¯¹æƒé‡çš„æƒ©ç½šï¼Œä¹Ÿå°±æ˜¯ W1ä¸€æ—¦è¿‡å¤§ï¼Œæƒ©ç½šå°±ä¼šå¾ˆå¤§ï¼Œè¿›ä¸€æ­¥åŽ‹ç¼© W1çš„å€¼ï¼Œä½¿ä»–ä¸è‡³äºŽè¿‡å¤§ã€‚ä½†æ˜¯ï¼Œæ ‘æ¨¡åž‹åˆ™ä¸ä¸€æ ·ï¼Œæ ‘æ¨¡åž‹çš„æƒ©ç½šé¡¹é€šå¸¸ä¸ºå¶å­èŠ‚ç‚¹æ•°å’Œæ·±åº¦ç­‰ï¼Œè€Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯¹äºŽä¸Šé¢è¿™ç§ caseï¼Œæ ‘åªéœ€è¦ä¸€ä¸ªèŠ‚ç‚¹å°±å¯ä»¥å®Œç¾Žåˆ†å‰²9990å’Œ10ä¸ªæ ·æœ¬ï¼Œä¸€ä¸ªç»“ç‚¹ï¼Œæœ€ç»ˆäº§ç”Ÿçš„æƒ©ç½šé¡¹æžå…¶ä¹‹å°ã€‚==

è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåœ¨é«˜ç»´ç¨€ç–ç‰¹å¾çš„æ—¶å€™ï¼Œçº¿æ€§æ¨¡åž‹ä¼šæ¯”éžçº¿æ€§æ¨¡åž‹å¥½çš„åŽŸå› äº†ï¼š**å¸¦æ­£åˆ™åŒ–çš„çº¿æ€§æ¨¡åž‹æ¯”è¾ƒä¸å®¹æ˜“å¯¹ç¨€ç–ç‰¹å¾è¿‡æ‹Ÿåˆã€‚**



### 3. XGBoostä¸­å¦‚ä½•å¯¹æ ‘è¿›è¡Œå‰ªæž

- åœ¨ç›®æ ‡å‡½æ•°ä¸­å¢žåŠ äº†æ­£åˆ™é¡¹ï¼šä½¿ç”¨å¶å­ç»“ç‚¹çš„æ•°ç›®å’Œå¶å­ç»“ç‚¹æƒé‡çš„L2æ¨¡çš„å¹³æ–¹ï¼ŒæŽ§åˆ¶æ ‘çš„å¤æ‚åº¦ã€‚
- åœ¨ç»“ç‚¹åˆ†è£‚æ—¶ï¼Œå®šä¹‰äº†ä¸€ä¸ªé˜ˆå€¼ï¼Œå¦‚æžœåˆ†è£‚åŽç›®æ ‡å‡½æ•°çš„å¢žç›Šå°äºŽè¯¥é˜ˆå€¼ï¼Œåˆ™ä¸åˆ†è£‚ã€‚
- å½“å¼•å…¥ä¸€æ¬¡åˆ†è£‚åŽï¼Œé‡æ–°è®¡ç®—æ–°ç”Ÿæˆçš„å·¦ã€å³ä¸¤ä¸ªå¶å­ç»“ç‚¹çš„æ ·æœ¬æƒé‡å’Œã€‚å¦‚æžœä»»ä¸€ä¸ªå¶å­ç»“ç‚¹çš„æ ·æœ¬æƒé‡ä½ŽäºŽæŸä¸€ä¸ªé˜ˆå€¼ï¼ˆæœ€å°æ ·æœ¬æƒé‡å’Œï¼‰ï¼Œä¹Ÿä¼šæ”¾å¼ƒæ­¤æ¬¡åˆ†è£‚ã€‚
- XGBoost å…ˆä»Žé¡¶åˆ°åº•å»ºç«‹æ ‘ç›´åˆ°æœ€å¤§æ·±åº¦ï¼Œå†ä»Žåº•åˆ°é¡¶åå‘æ£€æŸ¥æ˜¯å¦æœ‰ä¸æ»¡è¶³åˆ†è£‚æ¡ä»¶çš„ç»“ç‚¹ï¼Œè¿›è¡Œå‰ªæžã€‚



### 4. XGBoostå¦‚ä½•é€‰æ‹©æœ€ä½³åˆ†è£‚ç‚¹ï¼Ÿ 

XGBooståœ¨è®­ç»ƒå‰é¢„å…ˆå°†ç‰¹å¾æŒ‰ç…§ç‰¹å¾å€¼è¿›è¡Œäº†æŽ’åºï¼Œå¹¶å­˜å‚¨ä¸ºblockç»“æž„ï¼Œä»¥åŽåœ¨ç»“ç‚¹åˆ†è£‚æ—¶å¯ä»¥é‡å¤ä½¿ç”¨è¯¥ç»“æž„ã€‚

å› æ­¤ï¼Œå¯ä»¥é‡‡ç”¨ç‰¹å¾å¹¶è¡Œçš„æ–¹æ³•åˆ©ç”¨å¤šä¸ªçº¿ç¨‹åˆ†åˆ«è®¡ç®—æ¯ä¸ªç‰¹å¾çš„æœ€ä½³åˆ†å‰²ç‚¹ï¼Œæ ¹æ®æ¯æ¬¡åˆ†è£‚åŽäº§ç”Ÿçš„å¢žç›Šï¼Œæœ€ç»ˆé€‰æ‹©å¢žç›Šæœ€å¤§çš„é‚£ä¸ªç‰¹å¾çš„ç‰¹å¾å€¼ä½œä¸ºæœ€ä½³åˆ†è£‚ç‚¹ã€‚

å¦‚æžœåœ¨è®¡ç®—æ¯ä¸ªç‰¹å¾çš„æœ€ä½³åˆ†å‰²ç‚¹æ—¶ï¼Œå¯¹æ¯ä¸ªæ ·æœ¬éƒ½è¿›è¡ŒéåŽ†ï¼Œè®¡ç®—å¤æ‚åº¦ä¼šå¾ˆå¤§ï¼Œè¿™ç§å…¨å±€æ‰«æçš„æ–¹æ³•å¹¶ä¸é€‚ç”¨å¤§æ•°æ®çš„åœºæ™¯ã€‚XGBoostè¿˜æä¾›äº†ä¸€ç§ç›´æ–¹å›¾è¿‘ä¼¼ç®—æ³•ï¼Œå¯¹ç‰¹å¾æŽ’åºåŽä»…é€‰æ‹©å¸¸æ•°ä¸ªå€™é€‰åˆ†è£‚ä½ç½®ä½œä¸ºå€™é€‰åˆ†è£‚ç‚¹ï¼Œæžå¤§æå‡äº†ç»“ç‚¹åˆ†è£‚æ—¶çš„è®¡ç®—æ•ˆçŽ‡ã€‚



### 5. XGBoostçš„Scalableæ€§å¦‚ä½•ä½“çŽ°

- **åŸºåˆ†ç±»å™¨çš„scalability**ï¼šå¼±åˆ†ç±»å™¨å¯ä»¥æ”¯æŒCARTå†³ç­–æ ‘ï¼Œä¹Ÿå¯ä»¥æ”¯æŒLRå’ŒLinearã€‚
- **ç›®æ ‡å‡½æ•°çš„scalability**ï¼šæ”¯æŒè‡ªå®šä¹‰loss functionï¼Œåªéœ€è¦å…¶ä¸€é˜¶ã€äºŒé˜¶å¯å¯¼ã€‚æœ‰è¿™ä¸ªç‰¹æ€§æ˜¯å› ä¸ºæ³°å‹’äºŒé˜¶å±•å¼€ï¼Œå¾—åˆ°é€šç”¨çš„ç›®æ ‡å‡½æ•°å½¢å¼ã€‚
- **å­¦ä¹ æ–¹æ³•çš„scalability**ï¼šBlockç»“æž„æ”¯æŒå¹¶è¡ŒåŒ–ï¼Œæ”¯æŒ Out-of-coreè®¡ç®—ã€‚



### 6. XGBoostå¦‚ä½•è¯„ä»·ç‰¹å¾çš„é‡è¦æ€§

æˆ‘ä»¬é‡‡ç”¨ä¸‰ç§æ–¹æ³•æ¥è¯„åˆ¤XGBoostæ¨¡åž‹ä¸­ç‰¹å¾çš„é‡è¦ç¨‹åº¦ï¼š



```
 å®˜æ–¹æ–‡æ¡£ï¼š
ï¼ˆ1ï¼‰weight - the number of times a feature is used to split the data across all trees. ï¼ˆ2ï¼‰gain - the average gain of the feature when it is used in trees. 
ï¼ˆ3ï¼‰cover - the average coverage of the feature when it is used in trees.
```

- **weight** ï¼šè¯¥ç‰¹å¾åœ¨æ‰€æœ‰æ ‘ä¸­è¢«ç”¨ä½œåˆ†å‰²æ ·æœ¬çš„ç‰¹å¾çš„æ€»æ¬¡æ•°ã€‚
- **gain** ï¼šè¯¥ç‰¹å¾åœ¨å…¶å‡ºçŽ°è¿‡çš„æ‰€æœ‰æ ‘ä¸­äº§ç”Ÿçš„å¹³å‡å¢žç›Šã€‚
- **cover** ï¼šè¯¥ç‰¹å¾åœ¨å…¶å‡ºçŽ°è¿‡çš„æ‰€æœ‰æ ‘ä¸­çš„å¹³å‡è¦†ç›–èŒƒå›´ã€‚

> ==æ³¨æ„ï¼šè¦†ç›–èŒƒå›´è¿™é‡ŒæŒ‡çš„æ˜¯ä¸€ä¸ªç‰¹å¾ç”¨ä½œåˆ†å‰²ç‚¹åŽï¼Œå…¶å½±å“çš„æ ·æœ¬æ•°é‡ï¼Œå³æœ‰å¤šå°‘æ ·æœ¬ç»è¿‡è¯¥ç‰¹å¾åˆ†å‰²åˆ°ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚==



### 7. XGBooostå‚æ•°è°ƒä¼˜çš„ä¸€èˆ¬æ­¥éª¤

é¦–å…ˆéœ€è¦åˆå§‹åŒ–ä¸€äº›åŸºæœ¬å˜é‡ï¼Œä¾‹å¦‚ï¼š

- max_depth = 5
- min_child_weight = 1
- gamma = 0
- subsample, colsample_bytree = 0.8
- scale_pos_weight = 1

**(1) ç¡®å®šlearning rateå’Œestimatorçš„æ•°é‡**

learning rateå¯ä»¥å…ˆç”¨0.1ï¼Œç”¨cvæ¥å¯»æ‰¾æœ€ä¼˜çš„estimators

**(2) max_depthå’Œ min_child_weight**

æˆ‘ä»¬è°ƒæ•´è¿™ä¸¤ä¸ªå‚æ•°æ˜¯å› ä¸ºï¼Œè¿™ä¸¤ä¸ªå‚æ•°å¯¹è¾“å‡ºç»“æžœçš„å½±å“å¾ˆå¤§ã€‚æˆ‘ä»¬é¦–å…ˆå°†è¿™ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºè¾ƒå¤§çš„æ•°ï¼Œç„¶åŽé€šè¿‡è¿­ä»£çš„æ–¹å¼ä¸æ–­ä¿®æ­£ï¼Œç¼©å°èŒƒå›´ã€‚

max_depthï¼Œæ¯æ£µå­æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œcheck from range(3,10,2)ã€‚

min_child_weightï¼Œå­èŠ‚ç‚¹çš„æƒé‡é˜ˆå€¼ï¼Œcheck from range(1,6,2)ã€‚

å¦‚æžœä¸€ä¸ªç»“ç‚¹åˆ†è£‚åŽï¼Œå®ƒçš„æ‰€æœ‰å­èŠ‚ç‚¹çš„æƒé‡ä¹‹å’Œéƒ½å¤§äºŽè¯¥é˜ˆå€¼ï¼Œè¯¥å¶å­èŠ‚ç‚¹æ‰å¯ä»¥åˆ’åˆ†ã€‚

**(3) gamma**

ä¹Ÿç§°ä½œæœ€å°åˆ’åˆ†æŸå¤±`min_split_loss`ï¼Œcheck from 0.1 to 0.5ï¼ŒæŒ‡çš„æ˜¯ï¼Œå¯¹äºŽä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œå½“å¯¹å®ƒé‡‡å–åˆ’åˆ†ä¹‹åŽï¼ŒæŸå¤±å‡½æ•°çš„é™ä½Žå€¼çš„é˜ˆå€¼ã€‚

- å¦‚æžœå¤§äºŽè¯¥é˜ˆå€¼ï¼Œåˆ™è¯¥å¶å­èŠ‚ç‚¹å€¼å¾—ç»§ç»­åˆ’åˆ†
- å¦‚æžœå°äºŽè¯¥é˜ˆå€¼ï¼Œåˆ™è¯¥å¶å­èŠ‚ç‚¹ä¸å€¼å¾—ç»§ç»­åˆ’åˆ†

**(4) subsample, colsample_bytree**

subsampleæ˜¯å¯¹è®­ç»ƒçš„é‡‡æ ·æ¯”ä¾‹

colsample_bytreeæ˜¯å¯¹ç‰¹å¾çš„é‡‡æ ·æ¯”ä¾‹

both check from 0.6 to 0.9

**(5) æ­£åˆ™åŒ–å‚æ•°**

alpha æ˜¯L1æ­£åˆ™åŒ–ç³»æ•°ï¼Œtry 1e-5, 1e-2, 0.1, 1, 100

lambda æ˜¯L2æ­£åˆ™åŒ–ç³»æ•°

**(6) é™ä½Žå­¦ä¹ çŽ‡**

é™ä½Žå­¦ä¹ çŽ‡çš„åŒæ—¶å¢žåŠ æ ‘çš„æ•°é‡ï¼Œé€šå¸¸æœ€åŽè®¾ç½®å­¦ä¹ çŽ‡ä¸º0.01~0.1



### 8. XGBoostæ¨¡åž‹å¦‚æžœè¿‡æ‹Ÿåˆäº†æ€Žä¹ˆè§£å†³

å½“å‡ºçŽ°è¿‡æ‹Ÿåˆæ—¶ï¼Œæœ‰ä¸¤ç±»å‚æ•°å¯ä»¥ç¼“è§£ï¼š

- ç¬¬ä¸€ç±»å‚æ•°ï¼š==ç”¨äºŽç›´æŽ¥æŽ§åˆ¶æ¨¡åž‹çš„å¤æ‚åº¦==ã€‚åŒ…æ‹¬`max_depth,min_child_weight,gamma` ç­‰å‚æ•°

- ç¬¬äºŒç±»å‚æ•°ï¼š==ç”¨äºŽå¢žåŠ éšæœºæ€§ï¼Œä»Žè€Œä½¿å¾—æ¨¡åž‹åœ¨è®­ç»ƒæ—¶å¯¹äºŽå™ªéŸ³ä¸æ•æ„Ÿ==ã€‚åŒ…æ‹¬`subsample,colsample_bytree`

è¿˜æœ‰å°±æ˜¯ç›´æŽ¥å‡å°`learning rate`ï¼Œä½†éœ€è¦åŒæ—¶å¢žåŠ `estimator` å‚æ•°ã€‚



### 9.ä¸ºä»€ä¹ˆXGBoostç›¸æ¯”æŸäº›æ¨¡åž‹å¯¹ç¼ºå¤±å€¼ä¸æ•æ„Ÿ

å¯¹å­˜åœ¨ç¼ºå¤±å€¼çš„ç‰¹å¾ï¼Œä¸€èˆ¬çš„è§£å†³æ–¹æ³•æ˜¯ï¼š

- ç¦»æ•£åž‹å˜é‡ï¼šç”¨å‡ºçŽ°æ¬¡æ•°æœ€å¤šçš„ç‰¹å¾å€¼å¡«å……ï¼›
- è¿žç»­åž‹å˜é‡ï¼šç”¨ä¸­ä½æ•°æˆ–å‡å€¼å¡«å……ï¼›

ä¸€äº›æ¨¡åž‹å¦‚SVMå’ŒKNNï¼Œå…¶æ¨¡åž‹åŽŸç†ä¸­æ¶‰åŠåˆ°äº†å¯¹æ ·æœ¬è·ç¦»çš„åº¦é‡ï¼Œå¦‚æžœç¼ºå¤±å€¼å¤„ç†ä¸å½“ï¼Œæœ€ç»ˆä¼šå¯¼è‡´æ¨¡åž‹é¢„æµ‹æ•ˆæžœå¾ˆå·®ã€‚

è€Œæ ‘æ¨¡åž‹å¯¹ç¼ºå¤±å€¼çš„æ•æ„Ÿåº¦ä½Žï¼Œå¤§éƒ¨åˆ†æ—¶å€™å¯ä»¥åœ¨æ•°æ®ç¼ºå¤±æ—¶æ—¶ä½¿ç”¨ã€‚åŽŸå› å°±æ˜¯ï¼Œä¸€æ£µæ ‘ä¸­æ¯ä¸ªç»“ç‚¹åœ¨åˆ†è£‚æ—¶ï¼Œå¯»æ‰¾çš„æ˜¯æŸä¸ªç‰¹å¾çš„æœ€ä½³åˆ†è£‚ç‚¹ï¼ˆç‰¹å¾å€¼ï¼‰ï¼Œå®Œå…¨å¯ä»¥ä¸è€ƒè™‘å­˜åœ¨ç‰¹å¾å€¼ç¼ºå¤±çš„æ ·æœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœæŸäº›æ ·æœ¬ç¼ºå¤±çš„ç‰¹å¾å€¼ç¼ºå¤±ï¼Œå¯¹å¯»æ‰¾æœ€ä½³åˆ†å‰²ç‚¹çš„å½±å“ä¸æ˜¯å¾ˆå¤§ã€‚

XGBoostå¯¹ç¼ºå¤±æ•°æ®æœ‰ç‰¹å®šçš„å¤„ç†æ–¹æ³•ï¼Œ[è¯¦æƒ…å‚è€ƒä¸Šç¯‡æ–‡ç« ç¬¬7é¢˜](http://mp.weixin.qq.com/s?__biz=Mzg2MjI5Mzk0MA==&mid=2247484181&idx=1&sn=8d0e51fb0cb974f042e66659e1daf447&chksm=ce0b59cef97cd0d8cf7f9ae1e91e41017ff6d4c4b43a4c19b476c0b6d37f15769f954c2965ef&scene=21#wechat_redirect)ã€‚

å› æ­¤ï¼Œå¯¹äºŽæœ‰ç¼ºå¤±å€¼çš„æ•°æ®åœ¨ç»è¿‡ç¼ºå¤±å¤„ç†åŽï¼š

- å½“æ•°æ®é‡å¾ˆå°æ—¶ï¼Œä¼˜å…ˆç”¨æœ´ç´ è´å¶æ–¯
- æ•°æ®é‡é€‚ä¸­æˆ–è€…è¾ƒå¤§ï¼Œç”¨æ ‘æ¨¡åž‹ï¼Œä¼˜å…ˆXGBoost
- æ•°æ®é‡è¾ƒå¤§ï¼Œä¹Ÿå¯ä»¥ç”¨ç¥žç»ç½‘ç»œ
- é¿å…ä½¿ç”¨è·ç¦»åº¦é‡ç›¸å…³çš„æ¨¡åž‹ï¼Œå¦‚KNNå’ŒSVM



### 10. XGBoostå’ŒLightGBMçš„åŒºåˆ«

![image-20200326002104595](.images/image-20200326002104595.png)

ï¼ˆ1ï¼‰æ ‘ç”Ÿé•¿ç­–ç•¥ï¼šXGBé‡‡ç”¨`level-wise`çš„åˆ†è£‚ç­–ç•¥ï¼ŒLGBé‡‡ç”¨`leaf-wise`çš„åˆ†è£‚ç­–ç•¥ã€‚XGBå¯¹æ¯ä¸€å±‚æ‰€æœ‰èŠ‚ç‚¹åšæ— å·®åˆ«åˆ†è£‚ï¼Œä½†æ˜¯å¯èƒ½æœ‰äº›èŠ‚ç‚¹å¢žç›Šéžå¸¸å°ï¼Œå¯¹ç»“æžœå½±å“ä¸å¤§ï¼Œå¸¦æ¥ä¸å¿…è¦çš„å¼€é”€ã€‚Leaf-wiseæ˜¯åœ¨æ‰€æœ‰å¶å­èŠ‚ç‚¹ä¸­é€‰å–åˆ†è£‚æ”¶ç›Šæœ€å¤§çš„èŠ‚ç‚¹è¿›è¡Œçš„ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“å‡ºçŽ°è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦å¯¹æœ€å¤§æ·±åº¦åšé™åˆ¶ ã€‚

ï¼ˆ2ï¼‰åˆ†å‰²ç‚¹æŸ¥æ‰¾ç®—æ³•ï¼šXGBä½¿ç”¨ç‰¹å¾é¢„æŽ’åºç®—æ³•ï¼ŒLGBä½¿ç”¨åŸºäºŽç›´æ–¹å›¾çš„åˆ‡åˆ†ç‚¹ç®—æ³•ï¼Œå…¶ä¼˜åŠ¿å¦‚ä¸‹ï¼š

- å‡å°‘å†…å­˜å ç”¨ï¼Œæ¯”å¦‚ç¦»æ•£ä¸º256ä¸ªbinæ—¶ï¼Œåªéœ€è¦ç”¨8ä½æ•´å½¢å°±å¯ä»¥ä¿å­˜ä¸€ä¸ªæ ·æœ¬è¢«æ˜ å°„ä¸ºå“ªä¸ªbin(è¿™ä¸ªbinå¯ä»¥è¯´å°±æ˜¯è½¬æ¢åŽçš„ç‰¹å¾)ï¼Œå¯¹æ¯”é¢„æŽ’åºçš„exact greedyç®—æ³•æ¥è¯´ï¼ˆç”¨int_32æ¥å­˜å‚¨ç´¢å¼•+ ç”¨float_32ä¿å­˜ç‰¹å¾å€¼ï¼‰ï¼Œå¯ä»¥èŠ‚çœ7/8çš„ç©ºé—´ã€‚
- è®¡ç®—æ•ˆçŽ‡æé«˜ï¼Œé¢„æŽ’åºçš„Exact greedyå¯¹æ¯ä¸ªç‰¹å¾éƒ½éœ€è¦éåŽ†ä¸€éæ•°æ®ï¼Œå¹¶è®¡ç®—å¢žç›Šï¼Œå¤æ‚åº¦ä¸ºð‘‚(#ð‘“ð‘’ð‘Žð‘¡ð‘¢ð‘Ÿð‘’Ã—#ð‘‘ð‘Žð‘¡ð‘Ž)ã€‚è€Œç›´æ–¹å›¾ç®—æ³•åœ¨å»ºç«‹å®Œç›´æ–¹å›¾åŽï¼Œåªéœ€è¦å¯¹æ¯ä¸ªç‰¹å¾éåŽ†ç›´æ–¹å›¾å³å¯ï¼Œå¤æ‚åº¦ä¸ºð‘‚(#ð‘“ð‘’ð‘Žð‘¡ð‘¢ð‘Ÿð‘’Ã—#ð‘ð‘–ð‘›ð‘ )ã€‚
- LGBè¿˜å¯ä»¥ä½¿ç”¨ç›´æ–¹å›¾åšå·®åŠ é€Ÿï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„ç›´æ–¹å›¾å¯ä»¥é€šè¿‡çˆ¶èŠ‚ç‚¹çš„ç›´æ–¹å›¾å‡åŽ»å…„å¼ŸèŠ‚ç‚¹çš„ç›´æ–¹å›¾å¾—åˆ°ï¼Œä»Žè€ŒåŠ é€Ÿè®¡ç®—

> ä½†å®žé™…ä¸Šxgboostçš„è¿‘ä¼¼ç›´æ–¹å›¾ç®—æ³•ä¹Ÿç±»ä¼¼äºŽlightgbmè¿™é‡Œçš„ç›´æ–¹å›¾ç®—æ³•ï¼Œä¸ºä»€ä¹ˆxgboostçš„è¿‘ä¼¼ç®—æ³•æ¯”lightgbmè¿˜æ˜¯æ…¢å¾ˆå¤šå‘¢ï¼Ÿ
>
> xgbooståœ¨æ¯ä¸€å±‚éƒ½åŠ¨æ€æž„å»ºç›´æ–¹å›¾ï¼Œ å› ä¸ºxgboostçš„ç›´æ–¹å›¾ç®—æ³•ä¸æ˜¯é’ˆå¯¹æŸä¸ªç‰¹å®šçš„featureï¼Œè€Œæ˜¯æ‰€æœ‰featureå…±äº«ä¸€ä¸ªç›´æ–¹å›¾(æ¯ä¸ªæ ·æœ¬çš„æƒé‡æ˜¯äºŒé˜¶å¯¼)ï¼Œæ‰€ä»¥æ¯ä¸€å±‚éƒ½è¦é‡æ–°æž„å»ºç›´æ–¹å›¾ï¼Œè€Œlightgbmä¸­å¯¹æ¯ä¸ªç‰¹å¾éƒ½æœ‰ä¸€ä¸ªç›´æ–¹å›¾ï¼Œæ‰€ä»¥æž„å»ºä¸€æ¬¡ç›´æ–¹å›¾å°±å¤Ÿäº†ã€‚

ï¼ˆ3ï¼‰æ”¯æŒç¦»æ•£å˜é‡ï¼šæ— æ³•ç›´æŽ¥è¾“å…¥ç±»åˆ«åž‹å˜é‡ï¼Œå› æ­¤éœ€è¦äº‹å…ˆå¯¹ç±»åˆ«åž‹å˜é‡è¿›è¡Œç¼–ç ï¼ˆä¾‹å¦‚ç‹¬çƒ­ç¼–ç ï¼‰ï¼Œè€ŒLightGBMå¯ä»¥ç›´æŽ¥å¤„ç†ç±»åˆ«åž‹å˜é‡ã€‚

ï¼ˆ4ï¼‰ç¼“å­˜å‘½ä¸­çŽ‡ï¼šXGBä½¿ç”¨Blockç»“æž„çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å–æ¢¯åº¦çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡ç´¢å¼•æ¥èŽ·å–çš„ï¼Œè€Œè¿™äº›æ¢¯åº¦çš„èŽ·å–é¡ºåºæ˜¯æŒ‰ç…§ç‰¹å¾çš„å¤§å°é¡ºåºçš„ï¼Œè¿™å°†å¯¼è‡´éžè¿žç»­çš„å†…å­˜è®¿é—®ï¼Œå¯èƒ½ä½¿å¾—CPU cacheç¼“å­˜å‘½ä¸­çŽ‡ä½Žï¼Œä»Žè€Œå½±å“ç®—æ³•æ•ˆçŽ‡ã€‚è€ŒLGBæ˜¯åŸºäºŽç›´æ–¹å›¾åˆ†è£‚ç‰¹å¾çš„ï¼Œæ¢¯åº¦ä¿¡æ¯éƒ½å­˜å‚¨åœ¨ä¸€ä¸ªä¸ªbinä¸­ï¼Œæ‰€ä»¥è®¿é—®æ¢¯åº¦æ˜¯è¿žç»­çš„ï¼Œç¼“å­˜å‘½ä¸­çŽ‡é«˜ã€‚

ï¼ˆ5ï¼‰LightGBM ä¸Ž XGboost çš„å¹¶è¡Œç­–ç•¥ä¸åŒï¼š

- **ç‰¹å¾å¹¶è¡Œ** ï¼šLGBç‰¹å¾å¹¶è¡Œçš„å‰ææ˜¯æ¯ä¸ªworkerç•™æœ‰ä¸€ä»½å®Œæ•´çš„æ•°æ®é›†ï¼Œä½†æ˜¯æ¯ä¸ªworkerä»…åœ¨ç‰¹å¾å­é›†ä¸Šè¿›è¡Œæœ€ä½³åˆ‡åˆ†ç‚¹çš„å¯»æ‰¾ï¼›workerä¹‹é—´éœ€è¦ç›¸äº’é€šä¿¡ï¼Œé€šè¿‡æ¯”å¯¹æŸå¤±æ¥ç¡®å®šæœ€ä½³åˆ‡åˆ†ç‚¹ï¼›ç„¶åŽå°†è¿™ä¸ªæœ€ä½³åˆ‡åˆ†ç‚¹çš„ä½ç½®è¿›è¡Œå…¨å±€å¹¿æ’­ï¼Œæ¯ä¸ªworkerè¿›è¡Œåˆ‡åˆ†å³å¯ã€‚XGBçš„ç‰¹å¾å¹¶è¡Œä¸ŽLGBçš„æœ€å¤§ä¸åŒåœ¨äºŽXGBæ¯ä¸ªworkerèŠ‚ç‚¹ä¸­ä»…æœ‰éƒ¨åˆ†çš„åˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åž‚ç›´åˆ‡åˆ†ï¼Œæ¯ä¸ªworkerå¯»æ‰¾å±€éƒ¨æœ€ä½³åˆ‡åˆ†ç‚¹ï¼Œworkerä¹‹é—´ç›¸äº’é€šä¿¡ï¼Œç„¶åŽåœ¨å…·æœ‰æœ€ä½³åˆ‡åˆ†ç‚¹çš„workerä¸Šè¿›è¡ŒèŠ‚ç‚¹åˆ†è£‚ï¼Œå†ç”±è¿™ä¸ªèŠ‚ç‚¹å¹¿æ’­ä¸€ä¸‹è¢«åˆ‡åˆ†åˆ°å·¦å³èŠ‚ç‚¹çš„æ ·æœ¬ç´¢å¼•å·ï¼Œå…¶ä»–workeræ‰èƒ½å¼€å§‹åˆ†è£‚ã€‚äºŒè€…çš„åŒºåˆ«å°±å¯¼è‡´äº†LGBä¸­workeré—´é€šä¿¡æˆæœ¬æ˜Žæ˜¾é™ä½Žï¼Œåªéœ€é€šä¿¡ä¸€ä¸ªç‰¹å¾åˆ†è£‚ç‚¹å³å¯ï¼Œè€ŒXGBä¸­è¦å¹¿æ’­æ ·æœ¬ç´¢å¼•ã€‚

- **æ•°æ®å¹¶è¡Œ** ï¼šå½“æ•°æ®é‡å¾ˆå¤§ï¼Œç‰¹å¾ç›¸å¯¹è¾ƒå°‘æ—¶ï¼Œå¯é‡‡ç”¨æ•°æ®å¹¶è¡Œç­–ç•¥ã€‚LGBä¸­å…ˆå¯¹æ•°æ®æ°´å¹³åˆ‡åˆ†ï¼Œæ¯ä¸ªworkerä¸Šçš„æ•°æ®å…ˆå»ºç«‹èµ·å±€éƒ¨çš„ç›´æ–¹å›¾ï¼Œç„¶åŽåˆå¹¶æˆå…¨å±€çš„ç›´æ–¹å›¾ï¼Œé‡‡ç”¨ç›´æ–¹å›¾ç›¸å‡çš„æ–¹å¼ï¼Œå…ˆè®¡ç®—æ ·æœ¬é‡å°‘çš„èŠ‚ç‚¹çš„æ ·æœ¬ç´¢å¼•ï¼Œç„¶åŽç›´æŽ¥ç›¸å‡å¾—åˆ°å¦ä¸€å­èŠ‚ç‚¹çš„æ ·æœ¬ç´¢å¼•ï¼Œè¿™ä¸ªç›´æ–¹å›¾ç®—æ³•ä½¿å¾—workeré—´çš„é€šä¿¡æˆæœ¬é™ä½Žä¸€å€ï¼Œå› ä¸ºåªç”¨é€šä¿¡ä»¥æ­¤æ ·æœ¬é‡å°‘çš„èŠ‚ç‚¹ã€‚XGBä¸­çš„æ•°æ®å¹¶è¡Œä¹Ÿæ˜¯æ°´å¹³åˆ‡åˆ†ï¼Œç„¶åŽå•ä¸ªworkerå»ºç«‹å±€éƒ¨ç›´æ–¹å›¾ï¼Œå†åˆå¹¶ä¸ºå…¨å±€ï¼Œä¸åŒåœ¨äºŽæ ¹æ®å…¨å±€ç›´æ–¹å›¾è¿›è¡Œå„ä¸ªworkerä¸Šçš„èŠ‚ç‚¹åˆ†è£‚æ—¶ä¼šå•ç‹¬è®¡ç®—å­èŠ‚ç‚¹çš„æ ·æœ¬ç´¢å¼•ï¼Œå› æ­¤æ•ˆçŽ‡è´¼æ…¢ï¼Œæ¯ä¸ªworkeré—´çš„é€šä¿¡é‡ä¹Ÿå°±å˜å¾—å¾ˆå¤§ã€‚

- **æŠ•ç¥¨å¹¶è¡Œï¼ˆLGBï¼‰**ï¼šå½“æ•°æ®é‡å’Œç»´åº¦éƒ½å¾ˆå¤§æ—¶ï¼Œé€‰ç”¨æŠ•ç¥¨å¹¶è¡Œï¼Œè¯¥æ–¹æ³•æ˜¯æ•°æ®å¹¶è¡Œçš„ä¸€ä¸ªæ”¹è¿›ã€‚æ•°æ®å¹¶è¡Œä¸­çš„åˆå¹¶ç›´æ–¹å›¾çš„ä»£ä»·ç›¸å¯¹è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯å½“ç‰¹å¾ç»´åº¦å¾ˆå¤§æ—¶ã€‚å¤§è‡´æ€æƒ³æ˜¯ï¼šæ¯ä¸ªworkeré¦–å…ˆä¼šæ‰¾åˆ°æœ¬åœ°çš„ä¸€äº›ä¼˜ç§€çš„ç‰¹å¾ï¼Œç„¶åŽè¿›è¡Œå…¨å±€æŠ•ç¥¨ï¼Œæ ¹æ®æŠ•ç¥¨ç»“æžœï¼Œé€‰æ‹©topçš„ç‰¹å¾è¿›è¡Œç›´æ–¹å›¾çš„åˆå¹¶ï¼Œå†å¯»æ±‚å…¨å±€çš„æœ€ä¼˜åˆ†å‰²ç‚¹ã€‚

  

> å‚è€ƒï¼š
>
> 1.https://blog.csdn.net/u010665216/article/details/78532619
>
> 2.https://blog.csdn.net/jamexfx/article/details/93780308















